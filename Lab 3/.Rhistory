5 30 1 2.2
6 35 1 8.4
7 10 2 15.1
8 15 2 22.3
9 20 2 8.1
10 25 2 8.5
11 30 2 3.3
12 35 2 7.3
13 10 3 22.6
14 15 3 19.8
15 20 3 6.1
16 25 3 8.2
17 30 3 6.1
18 35 3 5.2
19 10 4 7.1
20 15 4 9.9
21 20 4 1.0
22 25 4 2.8
23 30 4 0.7
24 35 4 2.2"
biod <- read.delim(textConnection(biod), sep=" ")
biod
biod$salt
levels(biod$salt)
biod$salt <- factor(biod$salt)
levels(biod$salt)
# check the normal assumption
biod$block <- factor(biod$block)
boxplot(biod~salt)
with(biod, boxplot(biomass~salt))
source('~/.active-rstudio-document')
par(mfrow=c(1,1))
with(biod, boxplot(biomass~salt))
with(biod, tapply(biomass, salt, shapiro.test))
bartlett.test(biomass~salt, data=biod)
mod1 <- aov(biomass ~ salt + Error(block), data=biod)
summary(mod1)
mod4 <- aov(results~antibiotic + Error(lab), data=dlabs)
summary(mod4)
TukeyHSD(mod1, 'salt')
install.packages("agricolae")
require("agricolae")
?HSD.test
summary(mod6)
anova(mod5)
summary(mod1)
out <- with(biod, HSD.test(biomass, salt)
)
out <- with(biod, HSD.test(biomass, salt, DFerror = 5,
MSerror = 7.69))
summary(out)
out
bar.group(out$groups, density=6,
border="darkblue", las=1)
with(biod, tapply(biomass, list(salt), mean))
bar.group(out$groups, density=2, ylim=c(0,20)
border="darkblue", las=1)
with(biod, tapply(biomass, list(salt), mean))
bar.group(out$groups, density=2, ylim=c(0,20),
border="darkblue", las=1)
bar.group(out$groups, density=6, ylim=c(0,25),
border="darkblue", las=1)
par(mfrow=c(2,2))
plot(mod1)
#
mod1 <- aov(biomass ~ salt + Error(block), data=biod)
summary(mod1)
par(mfrow=c(2,2))
plot(mod1)
mod0 <- aov(biomass ~ salt + Error(block), data=biod)
mod0 <- aov(biomass ~ salt + block, data=biod)
plot(mod0)
mod0 <- aov(biomass ~ salt, data=biod)
plot(mod0)
with(biod, interaction.plot(salt, block, biomass, col = c(1,2,3,4)))
mod0 <- aov(biomass ~ salt + block, data=biod)
plot(mod0)
par(mfrow=c(2,2))
plot(mod0)
TukeyHSD(mod0, 'salt')
plot(TukeyHSD(mod0, 'salt'))
par(mfrow=c(1,1))
plot(TukeyHSD(mod0, 'salt'))
mod0 <- aov(biomass ~ salt + block, data=biod)
plot(mod0)
bartlett.test(biomass~salt*block, data=biod)
with(biod, tapply(biomass, block, shapiro.test))
thk <- read.csv("ScaleThickness.csv", sep=",")
head(thk)
levels(thk$supp)
factor(thk$dose)
with(biod, boxplot(thick~supp+dose))
with(thk, boxplot(thick~supp+dose))
with(thk, tapply(thick, supp, shapiro.test))
with(thk, tapply(thick, dose, shapiro.test))
bartlett.test(thick~supp, data=thk)
bartlett.test(thick~dose, data=thk)
bartlett.test(thick~dose*supp, data=thk)
mod2 <- aov(thick ~ dose + supp, data=thk)
mod2 <- aov(thick ~ dose*supp, data=thk)
summary(mod2)
with(thk, interaction.plot(dose, supp, thk, col = c(1,2)))
with(thk, interaction.plot(dose, supp, thk, col = c(1,2,3)))
with(thk, interaction.plot(dose, supp, thick, col = c(1,2,3)))
with(thk, interaction.plot(dose, supp, thick, col = c(1,2)))
with(thk, interaction.plot(supp, dose, thick, col = c(1,2,3)))
plot(TukeyHSD(mod2, 'dose'))
mod2 <- aov(thick ~ factor(dose)*supp, data=thk)
summary(mod2)
with(thk, interaction.plot(supp, dose, thick, col = c(1,2,3)))
plot(TukeyHSD(mod2, factor(dose))
)
plot(TukeyHSD(mod2, factor('dose')))
plot(TukeyHSD(mod2, 'supp'))
plot(TukeyHSD(mod2, factor('dose')))
TukeyHSD(mod2, factor('dose'))
par(mfrow=c(2,2))
plot(mod2)
thk <- read.csv("ScaleThickness.csv", sep=",")
par(mfrow=c(1,1))
# check the normal assumption
with(thk, boxplot(thick~supp+dose))
with(thk, tapply(thick, supp, shapiro.test))
with(thk, tapply(thick, dose, shapiro.test))
# check the homogeneity of variance
bartlett.test(thick~supp, data=thk)
bartlett.test(thick~dose, data=thk)
#
mod2 <- aov(thick ~ factor(dose)*supp, data=thk)
summary(mod2)
TukeyHSD(mod2, factor('dose'))
?pairwise.t.test()
?TukeyHSD
?I
install.packages("sna")
require(sna)
help("sna")
setwd("/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab/Lab 8")
##################
# Data 1: biomass
##################
biod <- "obs salt block biomass
1 10 1 11.8
2 15 1 21.3
3 20 1 8.8
4 25 1 10.4
5 30 1 2.2
6 35 1 8.4
7 10 2 15.1
8 15 2 22.3
9 20 2 8.1
10 25 2 8.5
11 30 2 3.3
12 35 2 7.3
13 10 3 22.6
14 15 3 19.8
15 20 3 6.1
16 25 3 8.2
17 30 3 6.1
18 35 3 5.2
19 10 4 7.1
20 15 4 9.9
21 20 4 1.0
22 25 4 2.8
23 30 4 0.7
24 35 4 2.2"
biod <- read.delim(textConnection(biod), sep=" ")
biod$salt <- factor(biod$salt)
biod$block <- factor(biod$block)
par(mfrow=c(1,1))
# check the normal assumption
with(biod, boxplot(biomass~salt))
with(biod, tapply(biomass, salt, shapiro.test))
with(biod, tapply(biomass, block, shapiro.test))
# check the homogeneity of variance
bartlett.test(biomass~salt, data=biod)
bartlett.test(biomass~salt*block, data=biod)
#
mod0 <- aov(biomass ~ salt + block, data=biod)
mod1 <- aov(biomass ~ salt + Error(block), data=biod)
summary(mod1)
with(biod, interaction.plot(salt, block, biomass, col = c(1,2,3,4)))
# Post hoc test
plot(TukeyHSD(mod0, 'salt'))
require("agricolae")
out <- with(biod, HSD.test(biomass, salt, DFerror = 5,
MSerror = 7.69))
bar.group(out$groups, density=6, ylim=c(0,25),
border="darkblue", las=1)
with(biod, tapply(biomass, list(salt), mean))
# Diagnostic plots
par(mfrow=c(2,2))
plot(mod0)
?resid
summary(lm(biod$biomass ~ biod$salt))
biod
summary(lm(biod$biomass ~ I(biod$salt)))
summary(lm(biod$biomass ~ biod$salt))
?defactor
as.numeric(biod$salt)
as.numeric(as.character(biod$salt))
summary(lm(biod$biomass ~ as.numeric(as.character(biod$salt))))
lm.mod <- lm(biod$biomass ~ as.numeric(as.character(biod$salt)))
summary(lm.mod)
plot(lm.mod)
avplots(lm.mod)
avPlots(lm.mod)
lm.mod.dummy <- lm(biod$biomass ~ biod$salt)
summary(lm.mod.dummy)
biod$salt
?pair
setwd("/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab/Lab 8")
##################
# Data 1: biomass
##################
biod <- "obs salt block biomass
1 10 1 11.8
2 15 1 21.3
3 20 1 8.8
4 25 1 10.4
5 30 1 2.2
6 35 1 8.4
7 10 2 15.1
8 15 2 22.3
9 20 2 8.1
10 25 2 8.5
11 30 2 3.3
12 35 2 7.3
13 10 3 22.6
14 15 3 19.8
15 20 3 6.1
16 25 3 8.2
17 30 3 6.1
18 35 3 5.2
19 10 4 7.1
20 15 4 9.9
21 20 4 1.0
22 25 4 2.8
23 30 4 0.7
24 35 4 2.2"
biod <- read.delim(textConnection(biod), sep=" ")
biod$salt <- factor(biod$salt)
biod$block <- factor(biod$block)
par(mfrow=c(1,1))
# check the normal assumption
with(biod, boxplot(biomass~salt))
with(biod, tapply(biomass, salt, shapiro.test))
with(biod, tapply(biomass, block, shapiro.test))
# check the homogeneity of variance
bartlett.test(biomass~salt, data=biod)
bartlett.test(biomass~salt*block, data=biod)
#
mod0 <- aov(biomass ~ salt + block, data=biod)
mod1 <- aov(biomass ~ salt + Error(block), data=biod)
summary(mod1)
with(biod, interaction.plot(salt, block, biomass, col = c(1,2,3,4)))
tdata <- read.csv("TreePlots.csv", header=T)
attach tdata
head(tdata)
tdata <- read.csv("TreePlots.csv", header=T)
setwd("/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab/Lab 9")
setwd("~/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab Github/ada/Lab 9")
tdata <- read.csv("TreePlots.csv", header=T)
attach(tdata)
head(tdata)
?pairs
pairs(tdata)
plot(mDBH.cm, mBA.cm2)
source("pair.fun.R")
pairs(tdat, lower.panel=panel.smooth,
upper.panel=panel.cor, diag.panel=panel.hist)
pairs(tdata, lower.panel=panel.smooth,
upper.panel=panel.cor, diag.panel=panel.hist)
?pairs
cor1 <- with(tdata, cor.test(mH.m, mWD.g.m3))
with(tdata, plot(mH.m, mWD.g.m3, xlab="Mean Height, m", ylab="Mean Wood Density, g per m3"))
with(tdata, plot(mH.m, mWD.g.m3, las = 1, xlab="Mean Height, m", ylab="Mean Wood Density, g per m3"))
cor2 <- with(tdata[mH.m < 22], cor.test(mH.m, mWD.g.m3))
with(tdata[mH.m < 22], plot(mH.m, mWD.g.m3, las = 1, xlab="Mean Height, m", ylab="Mean Wood Density, g per m3"))
cor2 <- with(tdata[mH.m < 22,], cor.test(mH.m, mWD.g.m3))
with(tdata[mH.m < 22,], plot(mH.m, mWD.g.m3, las = 1, xlab="Mean Height, m", ylab="Mean Wood Density, g per m3"))
cor1
cor2
?cor.test
summary(cor2)
cor(tdata)
?lm
require(graphics)
## Annette Dobson (1990) "An Introduction to Generalized Linear Models".
## Page 9: Plant Weight Data.
ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
weight <- c(ctl, trt)
lm.D9 <- lm(weight ~ group)
lm.D90 <- lm(weight ~ group - 1) # omitting intercept
anova(lm.D9)
summary(lm.D90)
opar <- par(mfrow = c(2,2), oma = c(0, 0, 1.1, 0))
plot(lm.D9, las = 1)      # Residuals, Fitted, ...
par(opar)
plot(lm.D90)
opar <- par(mfrow = c(2,2))
plot(lm.D90)
plot(lm.D9)
summary(lm.D9)
summary(lm.D90)
anova(lm.D90)
anova(lm.D9)
aov(ctl~trt)
aov(weight ~ group)
?gl
anova(lm.D9)
summary(aov(weight ~ group))
summary(lm.D90)
lm1 <- lm(AGBH.Mg.ha ~ mH.m, data = tdat)
anova(lm1)
tdata$mH.m
lm1 <- lm(AGBH.Mg.ha ~ mH.m, data = tdata)
summary(lm1)
anova(lm1)
plot(mH.m, AGBH.Mg.ha, lwd = 2, las = 1, pch = 19,     col = "grey", cex = 1.2,     xlab = "Mean height, m",     ylab = expression(paste("Biomass Mg ", ha^-1)))abline(lm(AGBH.Mg.ha ~ mH.m), col = "darkblue", lwd = 2)
plot(mH.m, AGBH.Mg.ha, lwd = 2, las = 1, pch = 19,
col = "grey", cex = 1.2,
xlab = "Mean height, m",
ylab = expression(paste("Biomass Mg ", ha^-1)))
abline(lm(AGBH.Mg.ha ~ mH.m), col = "darkblue", lwd = 2)
anova(lm1)
summary(lm1)
lm1$residuals
summary(lm1)
lm1
str(lm1)
lm1$coefficients
lm1$coefficients[1]
cor.test(y.fitted, lm1$fitted)
y.fitted <- lm1$coefficients[1] + lm1$coefficients[2]*tdata$mH.m
cor.test(y.fitted, lm1$fitted)
opar <- par(mfrow=c(2,2))
plot(lm1)
par <- opar
lm2 <- lm(AGBH.Mg.ha ~ mH.m, data = tdata[-c(25, 43, 63)])
anova(lm2)
summary(lm2)
summary(lm1)
lm2 <- lm(AGBH.Mg.ha ~ mH.m, data = tdata[-c(25, 43, 63),])
anova(lm2)
summary(lm2)
summary(lm1)
require(ggplot2)
tdat1 <- tdat[-c(25,43,63), ]
ggplot(tdat1, aes(x = mH.m, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean height, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
install.packages("ggplot2")
ggplot(tdat1, aes(x = mH.m, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean height, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
require(ggplot2)
tdat1 <- tdat[-c(25,43,63), ]
ggplot(tdat1, aes(x = mH.m, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean height, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
require(ggplot2)
tdat1 <- tdata[-c(25,43,63), ]
ggplot(tdat1, aes(x = mH.m, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean height, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
?ggplot
aov(AGBH.Mg.ha ~ mH.m, data=tdata)
anova(lm1)
summary(aov(AGBH.Mg.ha ~ mH.m, data=tdata))
head(tdata$mH.m)
head(tdata)
setwd("/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab/Lab 9")
tdata <- read.csv("TreePlots.csv", header=T)
attach(tdata)
# scatterplot
pairs(tdata)
source("pair.fun.R")
pairs(tdata, lower.panel=panel.smooth,
upper.panel=panel.cor, diag.panel=panel.hist)
cor(tdata)
lm1 <- lm(AGBH.Mg.ha ~ mDBH, data = tdata)
lm1 <- lm(AGBH.Mg.ha ~ mDBH.cm, data = tdata)
anova(lm1)
summary(lm1)
plot(mDBH.cm, AGBH.Mg.ha, lwd = 2, las = 1, pch = 19,
col = "grey", cex = 1.2,
xlab = "mean tree diameter, cm",
ylab = expression(paste("Biomass Mg ", ha^-1)))
abline(lm1, col = "darkblue", lwd = 2)
abline(lm(AGBH.Mg.ha ~ mDBH.cm), col = "darkblue", lwd = 2)
summary(lm1)
summary(lm2)
summary(lm1)
# correlation test
cor1 <- with(tdata, cor.test(mDBH.cm, AGBH.Mg.ha))
with(tdata, plot(mDBH.cm, AGBH.Mg.ha, las = 1))
cor1
cor1.1 <- with(tdata[mDBH.cm < 35], cor.test(mDBH.cm, AGBH.Mg.ha))
cor1.1 <- with(tdata[mDBH.cm < 35,], cor.test(mDBH.cm, AGBH.Mg.ha))
with(tdata[mDBH.cm < 35,], plot(mDBH.cm, AGBH.Mg.ha, las = 1))
cor1.1
shapiro.test(AGBH.Mg.ha)
opar <- par(mfrow=c(2,2))
plot(lm1)
par <- opar
tdata[61]
tdata[61,]
summary(tdata)
plot(mDBH.cm, AGBH.Mg.ha, lwd = 2, las = 1, pch = 19,
col = "grey", cex = 1.2,
xlab = "mean tree diameter, cm",
ylab = expression(paste("Biomass Mg ", ha^-1)))
abline(lm(AGBH.Mg.ha ~ mDBH.cm), col = "darkblue", lwd = 2)
require(ggplot2)
ggplot(tdata, aes(x = mDBH.cm, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm1) +
xlab("Mean tree diameter, cm") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
require(ggplot2)
require(ggplot2)
tdat1 <- tdata[-c(25,43,63), ]
ggplot(tdat1, aes(x = mH.m, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean height, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
ggplot(tdata, aes(x = mDBH.cm, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm1) +
xlab("Mean tree diameter, cm") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
require(ggplot2)
ggplot(tdata, aes(x = mDBH.cm, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm1) +
xlab("Mean height, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
require(ggplot2)
ggplot(tdata, aes(x = mH.m, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean height, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
summary(lm)
require(ggplot2)
ggplot(tdata, aes(x = mDBH.cm, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean tree diameter, m") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
ggplot(tdata, aes(x = mDBH.cm, y = AGBH.Mg.ha)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("Mean tree diameter, cm") +
ylab(expression(paste("Biomass Mg ", ha^-1)))
summary(lm1)
cor2 <- with(tdata, cor.test(mH.m, mWD.g.m3))
cor2 <- with(tdata, cor.test(mH.m, mWD.g.m3))
with(tdata, plot(mH.m, mWD.g.m3, las = 1))
par <- opar
with(tdata, plot(mH.m, mWD.g.m3, las = 1))
par(mfrow=c(1,1))
with(tdata, plot(mH.m, mWD.g.m3, las = 1))
cor2.1 <- with(tdata[mH.m < 24,], cor.test(mH.m, mWD.g.m3))
with(tdata[mH.m < 24,], plot(mH.m, mWD.g.m3, las = 1))
cor2
cor2.1
lm2 <- lm(mH.m ~ mWD.g.m3, data = tdata)
anova(lm2)
summary(lm2)
plot(mWD.g.m3, mH.m, lwd = 2, las = 1, pch = 19,
col = "grey", cex = 1.2,
xlab = "mean wood density, g per m3",
ylab = "mean height, m")
abline(lm(mH.m ~ mWD.g.m3), col = "darkblue", lwd = 2)
ggplot(tdata, aes(x = mWD.g.m3, y = mH.m)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("mean wood density, g per m3") +
ylab("mean height, m"))
ggplot(tdata, aes(x = mWD.g.m3, y = mH.m)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("mean wood density, g per m3") +
ylab("mean height, m")
# plot diagnostics
opar <- par(mfrow=c(2,2))
plot(lm2)
par <- opar
lm2 <- lm(mH.m ~ mWD.g.m3, data = tdata[mH.m < 24])
lm2 <- lm(mH.m ~ mWD.g.m3, data = tdata[mH.m < 24,])
summary(lm2)
opar <- par(mfrow=c(2,2))
plot(lm2)
par <- opar
ggplot(tdata[mH.m < 24,], aes(x = mWD.g.m3, y = mH.m)) +
geom_point(shape = 1) +
geom_smooth(method = lm) +
xlab("mean wood density, g per m3") +
ylab("mean height, m")
