{
    "contents" : "\nsetwd(\"/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab/Lab 6\")\nlibrary(boot)\n\n# Problem #1\n# Q1 & Q4\n# infer from one sample\nset.seed(1001)\nmysample <- rnorm(35, mean=20, sd=4)\nmymean <- mean(mysample)\nmysd <- sd(mysample)\nzcrit <- pnorm(0.975)\nmyci <- c(mymean - zcrit * mysd/sqrt(35), mymean + zcrit * mysd/sqrt(35))\n\n\n# Q2\n# sample 1000 times\nset.seed(1001)\nsample.means <- c()\nn <- 25\nfor (i in 1:1000) { sample.means[i] <- mean(rnorm(n, 20, 4))}\nhist(sample.means, las = 1, col = \"darkblue\", main=\"\")\nsegments(sort(sample.means)[25], 0, sort(sample.means)[25], 250, col=\"red\", lwd=2)\nsegments(sort(sample.means)[975], 0, sort(sample.means)[975], 250, col=\"red\", lwd=2)\n# use true population mean and sd\nsum(sample.means >= 20 - 2*4/sqrt(n) & sample.means <= 20 + 2*4/sqrt(n))/1000\n\n\n# Q3\nsum(sample.means >= 20 - 4/sqrt(n) & sample.means <= 20 + 4/sqrt(n))/1000\ntcrit <- qt(1-0.05/2, df=n-1)\nsamp.sd <- sd(sample.means)\nsamp.mean <- mean(sample.means)\nsum(sample.means >= samp.mean - tcrit*samp.sd & sample.means <= samp.mean + tcrit*samp.sd)/1000\n\n\n\n\n# Q5\n# resampling for two variables \ndat <- read.csv(\"Galapagos.csv\", header = T)\nattach(dat)\nplot(Area, Nspecies, pch=19, col=\"red\")\n# linear regression\nfit <- lm(Nspecies~Area)\nabline(fit, col=\"darkblue\")\n\n# draw the logrithm plot\nplot(log10(Area), log10(Nspecies), pch=19, col=\"red\")\n#plot(log10(Nspecies)~log10(Area), pch=19, col=\"red\")\n# linear regression\nLfit <- lm(log10(Nspecies)~log10(Area))\nabline(Lfit, col=\"darkblue\")\n\nLco <- Lfit$coefficients\n\n\n# bootstrapping the sample pairs\nruns <- 1000\nlen <- length(Nspecies)\nslope <- c()\nintercept <- c()\nfor(i in 1:runs){\n  samp <- dat[sample(nrow(dat), size=len, replace=T), ]\n  fit <- lm(log10(samp$Nspecies) ~ log10(samp$Area))\n  intercept[i] <- fit$coefficients[1]\n  slope[i] <- fit$coefficients[2]\n}\nmean.int <- mean(intercept)\nmean.slope <- mean(slope)\n\npar(mfrow=c(1,2))\nhist(intercept, las=1)\nabline(v=sort(intercept)[25], col=\"red\", lwd=1.5)\nabline(v=sort(intercept)[975], col=\"red\", lwd=1.5)\nci.int<-c(quantile(intercept, 0.025),\n          quantile(intercept, 0.975))\n\n\nhist(slope, las=1)\nabline(v=sort(slope)[25], col=\"red\", lwd=1.5)\nabline(v=sort(slope)[975], col=\"red\", lwd=1.5)\nci.slope<-c(quantile(slope, 0.025),\n            quantile(slope, 0.975))\n\n\n# Problem #2\ninsects <- c(0.14, 15.49, 29.04, 6.36, 1.83, 5.40, 31.89,\n             3.92, 0.54, 2.01, 12.67, 48.75)\nhist(insects, las = 1, ylab = \"No. species\",\n     xlab = \"Abundance\", main=\"\", col=\"lightgrey\")\nins.n <- length(insects)\n\ninsects.mean <- mean(insects)\ninsects.sm <- c()\nfor (i in 1:1000){\n  insect.sample <- sample(insects, ins.n, replace=T)\n  insects.sm[i] <- mean(insect.sample)\n}\nmean(insects.sm)\nboot.sd <- sd(insects.sm)\ninsects.se <- sd(insects)/sqrt(ins.n)\n# parametric approach to c.i.\nt <- qt(1 - 0.10/2, df=ins.n-1)\ninsects.ci <- c(insects.mean - t*insects.se, insects.mean + t*insects.se)\n# percentile approach to c.i.\ninsects.boot.ci <- c(quantile(insects.sm, 0.05), quantile(insects.sm, 0.95))\n\n\n",
    "created" : 1412798869679.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2622266783",
    "id" : "448A931B",
    "lastKnownWriteTime" : 1412818512,
    "path" : "~/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab/Lab 6/Hong Xu Lab 6 Turn In.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}