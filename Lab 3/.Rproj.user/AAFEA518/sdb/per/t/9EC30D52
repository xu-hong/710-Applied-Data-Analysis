{
    "contents" : "setwd(\"/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab/Lab 8\")\n\n##################\n# Data 1: biomass\n##################\nbiod <- \"obs salt block biomass\n1 10 1 11.8\n2 15 1 21.3\n3 20 1 8.8\n4 25 1 10.4\n5 30 1 2.2\n6 35 1 8.4\n7 10 2 15.1\n8 15 2 22.3\n9 20 2 8.1\n10 25 2 8.5\n11 30 2 3.3\n12 35 2 7.3\n13 10 3 22.6\n14 15 3 19.8\n15 20 3 6.1\n16 25 3 8.2\n17 30 3 6.1\n18 35 3 5.2\n19 10 4 7.1\n20 15 4 9.9\n21 20 4 1.0\n22 25 4 2.8\n23 30 4 0.7\n24 35 4 2.2\"\nbiod <- read.delim(textConnection(biod), sep=\" \")\nbiod$salt <- factor(biod$salt)\nbiod$block <- factor(biod$block)\n\npar(mfrow=c(1,1))\n# check the normal assumption\nwith(biod, boxplot(biomass~salt))\nwith(biod, tapply(biomass, salt, shapiro.test))\nwith(biod, tapply(biomass, block, shapiro.test))\n# check the homogeneity of variance\nbartlett.test(biomass~salt, data=biod)\nbartlett.test(biomass~salt*block, data=biod)\n\n# \nmod0 <- aov(biomass ~ salt + block, data=biod)\nmod1 <- aov(biomass ~ salt + Error(block), data=biod)\nsummary(mod1)\nwith(biod, interaction.plot(salt, block, biomass, col = c(1,2,3,4)))\n\n# Post hoc test\nplot(TukeyHSD(mod0, 'salt'))\nrequire(\"agricolae\")\nout <- with(biod, HSD.test(biomass, salt, DFerror = 5,\n                         MSerror = 7.69))\nbar.group(out$groups, density=6, ylim=c(0,25),\n          border=\"darkblue\", las=1)\nwith(biod, tapply(biomass, list(salt), mean))\n\n\n# Diagnostic plots\npar(mfrow=c(2,2))\nplot(mod0)\n\n##################\n# Data 2: thickness of scale\n# just for test\n##################\nthk <- read.csv(\"ScaleThickness.csv\", sep=\",\")\n\npar(mfrow=c(1,1))\n# check the normal assumption\nwith(thk, boxplot(thick~supp+dose))\nwith(thk, tapply(thick, supp, shapiro.test))\nwith(thk, tapply(thick, dose, shapiro.test))\n# check the homogeneity of variance\nbartlett.test(thick~supp, data=thk)\nbartlett.test(thick~dose, data=thk)\n\n\n# \nmod2 <- aov(thick ~ factor(dose)*supp, data=thk)\nsummary(mod2)\nwith(thk, interaction.plot(supp, dose, thick, col = c(1,2,3)))\n\n# Post hoc test\nplot(TukeyHSD(mod2, factor('dose')))\nplot(TukeyHSD(mod2, 'supp'))\n\n# Diagonistic plots\npar(mfrow=c(2,2))\nplot(mod2)\n",
    "created" : 1414355980580.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "520147324",
    "id" : "9EC30D52",
    "lastKnownWriteTime" : 1414645336,
    "path" : "~/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab Github/ada/Lab 8/Hong Xu Lab 8 Turn In.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}