unique(dat1$Intensity)
class(unique(dat1$Intensity))
xlight = unique(dat1$Intensity)
summary(lm.fo)
coef <- lm.f$Coefficients
?curve
curve(coef[0] + coef[1]*xlight + coef[2]*1, add=TRUE, col="red")
curve(coef[0] + coef[1]*x + coef[2]*1, add=TRUE, col="red")
curve(coef[1] + coef[2]*x + coef[3]*1, add=TRUE, col="red")
?seq
?rep
x <- unique(dat1$Intensity)
coef <- lm.f$Coefficients
curve(coef[1] + coef[2]*x + coef[3]*1, add=TRUE, col="red")
coef[1]
coef <- lm.f$Coefficients
coef
summary(lm.f)
class(lm.f)
vif(lm.f)
str(lm.f)
coef <- lm.f$coefficients
coef
curve(coef[1] + coef[2]*x + coef[3]*1, add=TRUE, col="red")
curve(coef[1] + coef[2]*x + coef[3]*1, add=TRUE, col="red")
curve(coef[1] + coef[2]*x + coef[3]*1, add=TRUE, col="red", lwd=2)
curve(coef[1] + coef[2]*x + coef[3]*0, add=TRUE, col="red", lwd=2)
curve(coef[1] + coef[2]*x + coef[3]*(-1), add=TRUE, col="red", lwd=2)
curve(coef[1] + coef[2]*x + coef[3]*(-1), add=TRUE, col="red", lty=2)
curve(expr(coef[1] + coef[2]*x + coef[3]*(-1)), add=TRUE, col="red", lty=2)
curve(expr(coef[1] + coef[2]*x + coef[3]), add=TRUE, col="red", lty=2)
curve(exp(coef[1] + coef[2]*x + coef[3]*0), add=TRUE, col="red", lty=2)
curve(exp(coef[1] + coef[2]*x + coef[3]*0), add=TRUE, col="red", lty=5)
curve(exp(coef[1] + coef[2]*x + coef[3]*0), add=TRUE, col="red", lty=2)
curve(exp(coef[1] + coef[2]*x + coef[3]*1), add=TRUE, col="grey", lty=2)
?seq
setwd("/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab Github/ada/Lab 10")
source("pair.fun.R")
require("Sleuth3")
require("car")
setwd("/Users/xuhong/Documents/Duke/Term 1 Courses/ENVIRON 710 Applied data analysis/Lab Github/ada/Lab 10")
source("pair.fun.R")
require("Sleuth3")
require("car")
tdat <- read.csv("TreePlotsA.csv")
dim(tdat)
pairs(tdat, lower.panel=panel.smooth, upper.panel=panel.cor,
diag.panel=panel.hist)
qqnorm(tdat$AGBH.Mg.ha)
qqline(tdat$AGBH.Mg.ha)
qqline(log(tdat$AGBH.Mg.ha))
qqnorm(log(tdat$AGBH.Mg.ha))
qqline(log(tdat$AGBH.Mg.ha))
head(tdat)
tdat$Tree.Fall
plot(tdat$Tree.Fall, tdat$AGBH.Mg.ha)
plot(tdat$mWD.g.m3, tdat$AGBH.Mg.ha)
pairs(log(tdat$mWD.g.m3), tdat$AGBH.Mg.ha)
plot(log(tdat$mWD.g.m3), tdat$AGBH.Mg.ha)
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mH.m*mWD.g.m3*mBA.cm2*factor(Tree.Fall)))
plot(log(tdat$mWD.g.m3), tdat$AGBH.Mg.ha)
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
with(tdat, corr(mDBH.cm, mH.m, mBA.cm2))
with(tdat, cor(mDBH.cm, mH.m, mBA.cm2))
cor(tdat)
with(tdat, cor(as.data.frame(mDBH.cm, mH.m, mBA.cm2)))
tdat$mDBH.cm
class(tdat)
cor(tdat[,"mDBH.cm"])
cor(tdat[,mDBH.cm])
tdat[:,mDBH.cm])
tdat[, tdat$mDBH.cm])
tdat[, tdat$mDBH.cm]
tdat[, mDBH.cm]
tdat[, c("mDBH.cm")]
tdat[, "mDBH.cm"]
df <- tdat[, c("mDBH.cm", "mH.m", "mBA.cm2")]
class(df)
cor(df)
head(tdat)
cor(tdat)
cor(tdat[, -8])
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3*factor(Tree.Fall)))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3 + factor(Tree.Fall)))
summary(lm0)
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3 + factor(Tree.Fall)*mDBH.cm
+ factor(Tree.Fall)*mWD.g.m3)
)
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3 + factor(Tree.Fall)))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
avPlots(lm.f)
plot(lm.f)
par(mfrow=c(2,2))
plot(lm.f)
lm0 <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3*factor(Tree.Fall)))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
lm0 <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3*factor(Tree.Fall)))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
lm1 <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3))
summary(lm1)
lm0 <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3 + factor(Tree.Fall)))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
lm.final <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3))
summary(lm.final)
plot(lm.final)
avPlots(lm.final)
with(tdat, plot(mDBH.cm, AGBH.Mg.ha))
with(tdat, plot(mWD.g.m3, AGBH.Mg.ha))
vif(lm.final)
head(tdat)
head(AGBH.Mg.ha.C)
head(tdat)
mean(tdat$AGBH.Mg.ha)
tdat$AGBH.Mg.ha - mean(tdat$AGBH.Mg.ha)
tdat$AGBH.Mg.ha.C <- tdat$AGBH.Mg.ha - mean(tdat$AGBH.Mg.ha)
tdat$mDBH.cm.C <- tdat$mDBH.cm- mean(tdat$mDBH.cm.C)
tdat$mDBH.cm.C <- tdat$mDBH.cm - mean(tdat$mDBH.cm)
tdat <- read.csv("TreePlotsA.csv")
tdat$mDBH.cm.C <- tdat$mDBH.cm - mean(tdat$mDBH.cm)
tdat$mWD.g.m3.C <- tdat$mWD.g.m3 - mean(tdat$mWD.g.m3)
lm.final.C <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm.C*mWD.g.m3.C))
summary(lm.final.C)
plot(lm.final.C)
plot(lm.final.C)
par(mfrow=c(2,2))
plot(lm.final.C)
avPlots(lm.final.C)
vif(lm.final.C)
summary(lm.final.C)
lm.t <- lm(AGBH.Mg.ha ~ factor(Tree.Fall))
with(tdat, lm.t <- lm(AGBH.Mg.ha ~ factor(Tree.Fall)))
summary(lm.t)
lm.t <- with(tdat, lm(AGBH.Mg.ha ~ factor(Tree.Fall)))
summary(lm.t)
anova(lm.t)
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3 + factor(Tree.Fall)))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
lm1 <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3 + factor(Tree.Fall)))
summary(lm1)
lm.f1 <- step(lm1)
summary(lm.f1)
summary(lm.f)
summary(lm.final)
summary(lm.final.C)
?plot
avPlots(lm.final.C)
with(tdat, plot(AGBH.Mg.ha, mDBH.cm.C))
summary(tdat$mWD.g.m3.C)
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red"))
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=21))
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=20)
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", bg="red", pch=20))
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", bg="red", pch=16))
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=16))
?seq
x <- seq(min(mDBH.cm.C), max(mDBH.cm.C), length=100)
x <- seq(min(tdat$mDBH.cm.C), max(tdat$mDBH.cm.C), length=100)
x
coeffs <- lm.final.C$coefficients
coeffs
coef <- lm.final.C$coefficients
curve(coef[1] + coef[2]*x + coef[3]*vals[0] + coef[4]*x*vals[0], col="grey", lwd=2)
summary(tdat$mWD.g.m3.C)
vals <- c(-0.25320, 0.01012, 0.30020)
curve(coef[1] + coef[2]*x + coef[3]*vals[0] + coef[4]*x*vals[0], col="grey", lwd=2)
curve(coef[1] + coef[2]*x + coef[3]*vals[0] + coef[4]*x*vals[0], col="grey", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[1] + coef[4]*x*vals[1], col="grey", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[2] + coef[4]*x*vals[2], col="blue", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[3] + coef[4]*x*vals[3], col="green", lwd=2, add=T)
summary(tdat$mWD.g.m3.C)
vals <- c(-0.02634, 0.01012, 0.30020)
curve(coef[1] + coef[2]*x + coef[3]*vals[1] + coef[4]*x*vals[1], col="grey", lwd=2, add=T)
vals <- c(-0.02, 0.01, 0.30)
# First, plot biomass (AGBH.Mg.ha) against mean tree diameter (mDBH.cm)
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=16))
summary(tdat$mWD.g.m3.C)
vals <- c(-0.02, 0.01, 0.30)
coef <- lm.final.C$coefficients
curve(coef[1] + coef[2]*x + coef[3]*vals[1] + coef[4]*x*vals[1], col="grey", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[2] + coef[4]*x*vals[2], col="blue", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[3] + coef[4]*x*vals[3], col="green", lwd=2, add=T)
vals <- c(-0.02, 0.01, 0.02)
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=16))
# Get three levels of mean wood density (mWD.g.m3)
summary(tdat$mWD.g.m3.C)
vals <- c(-0.02, 0.01, 0.02)
coef <- lm.final.C$coefficients
curve(coef[1] + coef[2]*x + coef[3]*vals[1] + coef[4]*x*vals[1], col="grey", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[2] + coef[4]*x*vals[2], col="blue", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[3] + coef[4]*x*vals[3], col="green", lwd=2, add=T)
summary(tdat$mWD.g.m3.C)
vals <- c(-0.02, 0.01, 0.10)
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=16))
coef <- lm.final.C$coefficients
curve(coef[1] + coef[2]*x + coef[3]*vals[1] + coef[4]*x*vals[1], col="grey", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[2] + coef[4]*x*vals[2], col="blue", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[3] + coef[4]*x*vals[3], col="green", lwd=2, add=T)
vals.orginal <- vals + mean(mWD.g.m3)
vals.orginal <- vals + mean(tdat$mWD.g.m3)
vals.original
vals.original <- vals + mean(tdat$mWD.g.m3)
vals.original
head(tdat$mWD.g.m3)
?round
vals.original <- round(vals.original, digits = 2)
vals.original
?legend
legend("topleft", "vals.original", lty = 1, col = c("grey", "red", "blue"), lwd = 2,
bty = "n")
legend("topleft", vals.original, lty = 1, col = c("grey", "red", "blue"), lwd = 2,
bty = "n")
legend("topleft", legend=vals.original, lty = 1, col = c("grey", "red", "blue"), lwd = 2,
bty = "n")
# First, plot biomass (AGBH.Mg.ha) against mean tree diameter (mDBH.cm)
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=16))
# Get three levels of mean wood density (mWD.g.m3)
summary(tdat$mWD.g.m3.C)
vals <- c(-0.02, 0.01, 0.10)
# Generate a sequence of mean tree diameter (mDBH.cm)
x <- seq(min(tdat$mDBH.cm.C), max(tdat$mDBH.cm.C), length=100)
# Plot curves at three levels of mean wood density (mWD.g.m3)
coef <- lm.final.C$coefficients
curve(coef[1] + coef[2]*x + coef[3]*vals[1] + coef[4]*x*vals[1], col="grey", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[2] + coef[4]*x*vals[2], col="blue", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[3] + coef[4]*x*vals[3], col="green", lwd=2, add=T)
vals.original <- vals + mean(tdat$mWD.g.m3)
vals.original <- round(vals.original, digits = 2)
legend("topleft", legend=vals.original, lty = 1, col = c("grey", "red", "blue"), lwd = 2,
bty = "n")
lm0 <- with(tdat, lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3*factor(Tree.Fall)))
summary(lm0)
lm.f <- step(lm0)
summary(lm.f)
par(mfrow=c(2,2))
plot(lm.f)
lm1 <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3 + factor(Tree.Fall)))
summary(lm1)
lm.f1 <- step(lm1)
summary(lm.f1)
plot(lm.f1)
lm.final <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm*mWD.g.m3))
summary(lm.final)
plot(lm.final)
avPlots(lm.final)
# center variables
tdat$mDBH.cm.C <- tdat$mDBH.cm - mean(tdat$mDBH.cm)
tdat$mWD.g.m3.C <- tdat$mWD.g.m3 - mean(tdat$mWD.g.m3)
# fit model, one more time
lm.final.C <- with(tdat[-47,], lm(AGBH.Mg.ha ~ mDBH.cm.C*mWD.g.m3.C))
summary(lm.final.C)
par(mfrow=c(2,2))
# diagnosis
plot(lm.final.C)
avPlots(lm.final.C)
vif(lm.final.C)
summary(lm.final.C)
?legend
legend("topleft", legend=vals.original, lty = 1, col = c("grey", "red", "blue"), lwd = 2,
bty = "n", title="mean wood density, g/m^3")
with(tdat, plot(mDBH.cm.C, AGBH.Mg.ha, xlab = "mean tree diameter in cm",
ylab = "plot biomass", col="red", pch=16))
# Get three levels of mean wood density (mWD.g.m3)
summary(tdat$mWD.g.m3.C)
vals <- c(-0.02, 0.01, 0.10)
# Generate a sequence of mean tree diameter (mDBH.cm)
x <- seq(min(tdat$mDBH.cm.C), max(tdat$mDBH.cm.C), length=100)
# Plot curves at three levels of mean wood density (mWD.g.m3)
coef <- lm.final.C$coefficients
curve(coef[1] + coef[2]*x + coef[3]*vals[1] + coef[4]*x*vals[1], col="grey", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[2] + coef[4]*x*vals[2], col="blue", lwd=2, add=T)
curve(coef[1] + coef[2]*x + coef[3]*vals[3] + coef[4]*x*vals[3], col="green", lwd=2, add=T)
vals.original <- vals + mean(tdat$mWD.g.m3)
vals.original <- round(vals.original, digits = 2)
legend("topleft", legend=vals.original, lty = 1, col = c("grey", "red", "blue"), lwd = 2,
bty = "n", title="mean wood density, g/m^3")
legend("topleft", legend=vals.original, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="mean wood density, g/m^3")
odat <- read.csv("ozone.data.csv")
head(odat)
summary(odat)
pairs(odat)
pairs(odat, lower.panel=panel.smooth, upper.panel=panel.cor,
diag.panel=panel.hist)]
diag.panel=panel.hist)
pairs(odat, lower.panel=panel.smooth, upper.panel=panel.cor,
diag.panel=panel.hist)
hist(log(odat$ozone))
qqnorm(log(odat$ozone))
qqline(log(odat$ozone))
hist(log(odat$ozone))
qqnorm(odat$ozone)
qqnorm(log(odat$ozone))
qqline(log(odat$ozone))
qqnorm(odat$ozone)
hist(odat$ozone)
hist(log(odat$ozone))
hist(log(odat$ozone))
cor(odat)
odat$l.ozone <- log(odat$ozone)
pairs(odat)
pairs(odat, lower.panel=panel.smooth, upper.panel=panel.cor,
diag.panel=panel.hist)
lm.oz.0 <- with(odat, lm(log(ozone) ~ temp*rad*wind))
summary(lm.oz.0)
lm.oz.1 <- update(lm.oz.0, ~.-temp:rad:wind)
summary(lm.oz.1)
lm.oz.2 <- update(lm.oz.1, ~.-temp:rad)
summary(lm.oz.2)
lm.oz.3 <- update(lm.oz.2, ~.-rad:wind)
summary(lm.oz.3)
anova(lm.oz.0, lm.oz.1, lm.oz.2, lm.oz.3)
lm.oz.f <- step(lm.oz.0)
summary(lm.oz.f)
AIC(lm.oz.0, lm.oz.1, lm.oz.2, lm.oz.3)
lm.oz.f <- stepAIC(lm.oz.0)
anova(lm.oz.0, lm.oz.1, lm.oz.2, lm.oz.3)
summary(lm.oz.3)
lm.oz.4 <- update(lm.oz.3, ~.-wind)
summary(lm.oz.4)
anova(lm.oz.0, lm.oz.1, lm.oz.2, lm.oz.3, lm.oz.4)
AIC(lm.oz.0, lm.oz.1, lm.oz.2, lm.oz.3, lm.oz.4)
summary(lm.oz.3)
plot(lm.oz.3)
par(mfrow=c(2,2))
plot(lm.oz.3)
plot(lm.oz.3)
par(mfrow=c(2,2))
plot(lm.oz.3)
par(mfrow=c(2,2))
plot(lm.oz.3)
summary(odat$wind)
summary(odat$rad)
wval <- c(7.4, 9.7, 11.5)
rval <- c(113.5, 184.8, 255.5)
vif(lm.oz.3)
with(odat, plot(temp, l.ozone))
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="ozone concentration", pch=10))
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="ozone concentration", pch=15))
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="ozone concentration", pch=16))
par(mfrow=c(1,1))
par(mfrow=c(1,1))
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="ozone concentration", pch=16,
col="red"))
avPlots(lm.oz.3)
par(mfrow=c(1,1))
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="ozone concentration", pch=16,
col="red"))
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red"))
x <- with(odat, seq(min(temp), max(temp), length=100))
coef <- lm.oz.3$coefficients
coef
coef <- lm.oz.3$coefficients
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
summary(odat$wind)
summary(odat$rad)
hist(odat$rad)
wval <- c(5, 10, 15)
rval <- c(50, 150, 250)
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
x <- with(odat, seq(min(temp), max(temp), length=100))
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
?legend
legend("topleft", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 150")
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 150")
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 150")
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
x <- with(odat, seq(min(temp), max(temp), length=100))
coef <- lm.oz.3$coefficients
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 150")
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 50")
par(mfrow=c(3,1))
x <- with(odat, seq(min(temp), max(temp), length=100))
coef <- lm.oz.3$coefficients
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 50")
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 150")
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
curve(coef[1] + coef[2]*x + coef[3]*rval[3] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[3] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[3] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 250")
par(mfrow=c(1,1))
x <- with(odat, seq(min(temp), max(temp), length=100))
coef <- lm.oz.3$coefficients
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[1] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 50")
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[2] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 150")
with(odat, plot(temp, l.ozone, xlab="temperature", ylab="log(ozone concentration)", pch=16,
col="red", cex.axis=0.8))
curve(coef[1] + coef[2]*x + coef[3]*rval[3] + coef[4]*wval[1] + coef[5]*x*wval[1],
add = T, col = "grey", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[3] + coef[4]*wval[2] + coef[5]*x*wval[2],
add = T, col = "blue", lwd = 2)
curve(coef[1] + coef[2]*x + coef[3]*rval[3] + coef[4]*wval[3] + coef[5]*x*wval[3],
add = T, col = "green", lwd = 2)
legend("bottomright", legend=wval, lty = 1, col = c("grey", "blue", "green"), lwd = 2,
bty = "n", title="wind speed at radiation 250")
summary(lm.oz.3)
exp(0.25939)
0.0782341-0.0029299*10
exp(0.0489351)
